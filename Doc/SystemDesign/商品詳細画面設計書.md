# 商品詳細画面設計書

## 目次
- [1. 基本情報](#1-基本情報)
- [2. 画面概要](#2-画面概要)
- [3. UI要素一覧](#3-ui要素一覧)
- [4. 機能仕様](#4-機能仕様)
- [5. バリデーション](#5-バリデーション)
- [6. セキュリティ](#6-セキュリティ)
- [7. レイアウト](#7-レイアウト)
- [8. 使用技術](#8-使用技術)
- [9. データ仕様](#9-データ仕様)

---

## 1. 基本情報

| 項目 | 内容 |
|------|------|
| 画面ID | PROD-DETAIL-001 |
| 画面名 | 商品詳細画面 |
| URL | /admin/products/{productId} |
| アクセス権限 | 管理者のみ |
| 作成日 | 2026年2月4日 |
| 更新日 | 2026年2月4日 |

---

## 2. 画面概要

選択した商品の詳細情報を表示する画面です。基本情報・詳細情報・入出庫履歴を一覧で確認でき、商品の全体像を把握できます。この画面から編集・削除・履歴閲覧などの操作が可能です。

### 主な機能
- 商品の基本情報表示（商品ID、商品名、カテゴリ、価格、在庫数など）
- 商品の詳細情報表示（保証期間、寸法、バリエーション、製造日など）
- 入出庫履歴の表示（直近3件）
- 商品の編集機能（編集画面への遷移）
- 商品の削除機能（論理削除）
- すべての履歴表示（履歴画面への遷移）
- 商品一覧への戻り機能

### 画面の特徴
- **一覧性の高い情報表示**：基本情報と詳細情報をカード形式で整理
- **視覚的なフィードバック**：在庫状況、ステータス、カテゴリをBadgeで表示
- **履歴の可視化**：直近の入出庫履歴を時系列で表示
- **即座のアクション**：編集・削除ボタンを画面上部に配置

---

## 3. UI要素一覧

### 3.1 ナビゲーションバー（管理者用）

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 1 | ロゴ/リンク | システム名 | link | - | 「商品在庫管理システム」<br>/admin/menuへ遷移<br>管理者バッジ表示 |
| 2 | ナビゲーションリンク | 在庫管理 | link | - | /admin/inventoryへ遷移<br>アイコン：bi-clipboard-data |
| 3 | ナビゲーションリンク | 商品管理 | link | - | /admin/productsへ遷移<br>アイコン：bi-box-seam<br>現在地：active状態 |
| 4 | ナビゲーションリンク | ユーザー管理 | link | - | /admin/usersへ遷移<br>アイコン：bi-people |
| 5 | ナビゲーションリンク | メニュー | link | - | /admin/menuへ遷移<br>アイコン：bi-house |
| 6 | ボタン | ログアウト | submit | - | /logoutへPOST送信<br>アイコン：bi-box-arrow-right |

### 3.2 パンくずリスト

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 7 | リンク | ホーム | link | - | /admin/menuへ遷移 |
| 8 | リンク | 商品管理 | link | - | /admin/productsへ遷移 |
| 9 | テキスト | 商品詳細 | text | - | 現在地（非リンク） |

### 3.3 ページヘッダー

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 10 | 見出し | ページタイトル | - | - | 「商品詳細」<br>アイコン：bi-box-seam |
| 11 | ボタングループ | アクション | - | - | 右上に配置 |
| 12 | ボタン | 編集ボタン | button | - | /admin/products/{productId}/editへ遷移<br>アイコン：bi-pencil<br>スタイル：btn-primary |
| 13 | ボタン | 削除ボタン | button | - | 削除確認モーダルを開く<br>アイコン：bi-trash<br>スタイル：btn-outline-danger |

### 3.4 商品基本情報カード

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 14 | カードヘッダー | セクションタイトル | - | - | 「基本情報」<br>アイコン：bi-info-circle<br>スタイル：bg-primary text-white |
| 15 | テーブル（左列） | 商品ID | text | - | ラベル：「商品ID (Product ID)」<br>`<code>`タグで表示<br>例：93TGNAY7 |
| 16 | テーブル（左列） | 商品名 | text | - | ラベル：「商品名 (Product Name)」<br>`<strong>`タグで強調表示<br>例：Laptop |
| 17 | テーブル（左列） | カテゴリ | badge | - | ラベル：「カテゴリ (Product Category)」<br>Badgeで表示<br>Electronics：bg-primary<br>Clothing：bg-info<br>Home Appliances：bg-secondary |
| 18 | テーブル（左列） | SKU | text | - | ラベル：「SKU (在庫管理番号)」<br>`<code>`タグで表示<br>例：8NMFZ4 |
| 19 | テーブル（左列） | 商品説明 | text | - | ラベル：「商品説明 (Product Description)」<br>通常テキスト表示 |
| 20 | テーブル（右列） | 価格 | text | - | ラベル：「価格 (Price)」<br>¥表記<br>text-primaryクラスで強調<br>小数点2桁まで表示 |
| 21 | テーブル（右列） | 在庫数 | text/badge | - | ラベル：「在庫数 (Stock Quantity)」<br>在庫状態に応じた表示<br>0個：stock-alert（赤色）<br>1-20個：stock-warning（オレンジ色）<br>21個以上：通常表示<br>アイコン付き |
| 22 | テーブル（右列） | ステータス | badge | - | ラベル：「ステータス」<br>販売中：badge-status-active（緑）<br>販売停止：badge-status-inactive（グレー） |
| 23 | テーブル（右列） | 商品評価 | text/icon | - | ラベル：「商品評価 (Product Ratings)」<br>星アイコン表示（5段階）<br>数値表示（例：2.0 / 5.0）<br>星：bi-star-fill（塗りつぶし）<br>半星：bi-star-half<br>空星：bi-star |

### 3.5 商品詳細情報カード

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 24 | カードヘッダー | セクションタイトル | - | - | 「詳細情報」<br>アイコン：bi-list-ul<br>スタイル：bg-secondary text-white |
| 25 | テーブル（左列） | 保証期間 | text | - | ラベル：「保証期間 (Warranty Period)」<br>例：2年 |
| 26 | テーブル（左列） | 商品寸法 | text | - | ラベル：「商品寸法 (Product Dimensions)」<br>例：16x15x15 cm |
| 27 | テーブル（左列） | 色/サイズバリエーション | badge | - | ラベル：「色/サイズバリエーション (Color/Size Variations)」<br>Badgeで表示<br>スタイル：bg-success |
| 28 | テーブル（右列） | 製造日 | text | - | ラベル：「製造日 (Manufacturing Date)」<br>YYYY-MM-DD形式<br>例：2023-01-01 |
| 29 | テーブル（右列） | 有効期限 | text | - | ラベル：「有効期限 (Expiration Date)」<br>YYYY-MM-DD形式<br>例：2026-01-01 |
| 30 | テーブル（右列） | 商品タグ | badge | - | ラベル：「商品タグ (Product Tags)」<br>複数のBadgeで表示<br>スタイル：bg-info |

### 3.6 入出庫履歴カード

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 31 | カードヘッダー | セクションタイトル | - | - | 「入出庫履歴」<br>アイコン：bi-clock-history<br>スタイル：bg-info text-white |
| 32 | テーブルヘッダー | 日時 | - | - | 取引日時を表示 |
| 33 | テーブルヘッダー | 種別 | - | - | 入庫/出庫/調整 |
| 34 | テーブルヘッダー | 数量 | - | - | 変動数量（+/-付き） |
| 35 | テーブルヘッダー | 在庫数（変更後） | - | - | 変更後の在庫数 |
| 36 | テーブルヘッダー | 担当者 | - | - | 実行ユーザー名 |
| 37 | テーブルヘッダー | 備考 | - | - | 取引の理由・メモ |
| 38 | テーブルセル | 日時表示 | text | - | YYYY-MM-DD HH:mm形式<br>例：2026-02-01 10:30 |
| 39 | テーブルセル | 種別表示 | badge | - | 入庫：bg-success（緑）<br>出庫：bg-danger（赤）<br>調整：bg-warning（黄） |
| 40 | テーブルセル | 数量表示 | text | - | +記号（入庫）<br>-記号（出庫）<br>例：+50、-20 |
| 41 | テーブルセル | 在庫数表示 | text | - | 変更後の在庫数<br>例：53個 |
| 42 | テーブルセル | 担当者表示 | text | - | 実行ユーザーの氏名<br>例：山田太郎 |
| 43 | テーブルセル | 備考表示 | text | - | 取引の理由・メモ<br>例：定期補充、販売 |
| 44 | ボタン | すべての履歴を表示 | button | - | /admin/products/{productId}/transactionsへ遷移<br>アイコン：bi-list-task<br>スタイル：btn-outline-primary |

### 3.7 アクションボタン

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 45 | ボタン | 商品一覧に戻る | button | - | /admin/productsへ遷移<br>アイコン：bi-arrow-left<br>スタイル：btn-secondary |

### 3.8 削除確認モーダル

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 46 | モーダルヘッダー | タイトル | - | - | 「削除確認」<br>アイコン：bi-exclamation-triangle<br>スタイル：bg-danger text-white |
| 47 | テキスト | 確認メッセージ | text | - | 「この商品を削除してもよろしいですか？」 |
| 48 | テキスト | 注意事項 | text | - | 「※論理削除されるため、データは保持されます。」<br>スタイル：text-muted |
| 49 | テキスト | 商品ID表示 | text | - | 「商品ID: {商品ID}」<br>`<code>`タグで表示 |
| 50 | ボタン | キャンセルボタン | button | - | モーダルを閉じる<br>スタイル：btn-secondary |
| 51 | ボタン | 削除するボタン | button | - | 削除処理を実行<br>スタイル：btn-danger |

---

## 4. 機能仕様

### 4.1 画面表示機能

#### 4.1.1 商品詳細情報表示
- **処理概要**：URLパラメータの商品IDに基づいて商品情報を取得し表示
- **取得項目**：
  - **基本情報**：商品ID、商品名、カテゴリ、SKU、商品説明、価格、在庫数、ステータス、商品評価
  - **詳細情報**：保証期間、商品寸法、色/サイズバリエーション、製造日、有効期限、商品タグ
- **表示形式**：
  - カテゴリ：Badgeで色分け表示
  - 価格：¥表記、小数点2桁、text-primaryで強調
  - 在庫数：在庫状態に応じた色分けとアイコン表示
  - ステータス：Badgeで表示
  - 商品評価：星アイコンと数値（0.0〜5.0）
- **エラーハンドリング**：
  - 商品IDが存在しない場合：404エラー画面を表示
  - 削除済み商品の場合：警告メッセージを表示

#### 4.1.2 入出庫履歴表示
- **処理概要**：選択した商品の入出庫履歴を最新3件表示
- **表示項目**：日時、種別、数量、在庫数（変更後）、担当者、備考
- **表示順**：新しい順（降順）
- **種別の色分け**：
  - 入庫：bg-success（緑）
  - 出庫：bg-danger（赤）
  - 調整：bg-warning（黄）
- **数量表示**：
  - 入庫：+記号付き（例：+50）
  - 出庫：-記号付き（例：-20）
- **履歴がない場合**：「履歴がありません」というメッセージを表示

#### 4.1.3 在庫状態の視覚化
- **在庫切れ（0個）**：
  - クラス：stock-alert
  - 色：赤色
  - アイコン：bi-x-circle-fill
- **在庫不足（1-20個）**：
  - クラス：stock-warning
  - 色：オレンジ色
  - アイコン：bi-exclamation-triangle-fill
- **在庫十分（21個以上）**：
  - クラス：stock-ok
  - 色：通常表示
  - アイコン：なし

#### 4.1.4 商品評価の表示
- **評価方式**：5段階評価（0.0〜5.0）
- **星アイコン表示**：
  - 塗りつぶし星：bi-star-fill（評価分）
  - 半星：bi-star-half（0.5単位）
  - 空星：bi-star（残り）
- **数値表示**：「2.0 / 5.0」形式
- **色**：text-warning（黄色）

### 4.2 編集機能

#### 4.2.1 商品編集画面への遷移
- **実行方法**：ページヘッダーの「編集」ボタンをクリック
- **遷移先**：/admin/products/{productId}/edit
- **遷移方法**：GETリクエスト
- **パラメータ**：商品ID
- **権限チェック**：管理者権限を確認

### 4.3 削除機能

#### 4.3.1 削除確認モーダル表示
- **実行方法**：ページヘッダーの「削除」ボタンをクリック
- **表示内容**：
  - 削除確認メッセージ
  - 論理削除の注意事項
  - 削除対象の商品ID
- **モーダル操作**：
  - キャンセル：モーダルを閉じる
  - 削除する：削除処理を実行

#### 4.3.2 商品削除処理（論理削除）
- **処理概要**：商品を論理削除する
- **削除方式**：論理削除（deleted_atカラムに削除日時を記録）
- **処理内容**：
  1. deleted_atカラムに現在日時を記録
  2. ステータスを'deleted'に変更
  3. 商品一覧画面にリダイレクト
  4. 成功メッセージを表示
- **制約**：
  - 削除済み商品は通常の一覧に表示されない
  - データは物理的に削除されない
  - 復元可能
- **エラーハンドリング**：
  - 削除失敗時：エラーメッセージを表示
  - 既に削除済みの場合：警告メッセージを表示

### 4.4 履歴閲覧機能

#### 4.4.1 すべての履歴を表示
- **実行方法**：入出庫履歴カード内の「すべての履歴を表示」ボタンをクリック
- **遷移先**：/admin/products/{productId}/transactions
- **遷移方法**：GETリクエスト
- **パラメータ**：商品ID
- **表示内容**：選択した商品の全入出庫履歴
- **機能**：
  - ページネーション
  - 期間フィルタ
  - CSVエクスポート

### 4.5 画面遷移機能

#### 4.5.1 商品一覧への遷移
- **遷移方法**：
  - パンくずリストの「商品管理」をクリック
  - 画面下部の「商品一覧に戻る」ボタンをクリック
- **遷移先**：/admin/products

#### 4.5.2 管理者メニューへの遷移
- **遷移方法**：
  - ナビゲーションバーのシステム名をクリック
  - パンくずリストの「ホーム」をクリック
- **遷移先**：/admin/menu

#### 4.5.3 他の管理画面への遷移
- **在庫管理**：/admin/inventory
- **ユーザー管理**：/admin/users

#### 4.5.4 ログアウト
- **実行方法**：ナビゲーションバーの「ログアウト」ボタンをクリック
- **処理**：/logoutへPOST送信
- **遷移先**：ログイン画面（/admin/login）

---

## 5. バリデーション

### 5.1 URL パラメータバリデーション

| 項目 | バリデーション内容 |
|------|-------------------|
| 商品ID（productId） | ・必須パラメータ<br>・英数字8文字<br>・データベースに存在する商品IDのみ<br>・存在しない場合は404エラー |

### 5.2 権限チェック

| 項目 | バリデーション内容 |
|------|-------------------|
| アクセス権限 | ・管理者権限が必要<br>・未認証ユーザーはログイン画面へリダイレクト<br>・一般ユーザーは403エラー |

### 5.3 削除処理バリデーション

| 項目 | バリデーション内容 |
|------|-------------------|
| 削除対象商品 | ・商品IDが存在すること<br>・既に削除済みでないこと<br>・削除権限があること |

### 5.4 エラーメッセージ

| エラー種別 | メッセージ内容 |
|-----------|---------------|
| 商品が見つからない | 「商品ID「{商品ID}」が見つかりません」 |
| 既に削除済み | 「商品ID「{商品ID}」は既に削除されています」 |
| 削除失敗 | 「商品の削除に失敗しました。もう一度お試しください」 |
| 権限エラー | 「この操作を実行する権限がありません」 |
| システムエラー | 「システムエラーが発生しました。管理者に連絡してください」 |

---

## 6. セキュリティ

### 6.1 認証・認可

| 項目 | 対策内容 |
|------|---------|
| 認証 | ・管理者ログイン認証必須<br>・未認証ユーザーは管理者ログイン画面へリダイレクト |
| 認可 | ・管理者権限チェック<br>・一般ユーザーがアクセスした場合は403エラー |
| セッション管理 | ・Spring Securityによるセッション管理<br>・セッションタイムアウト：30分<br>・管理者専用セッション |
| CSRF対策 | ・削除処理でCSRFトークン検証を実施<br>・POSTリクエストに必須 |

### 6.2 データ保護

| 項目 | 対策内容 |
|------|---------|
| 通信暗号化 | ・HTTPS通信を推奨<br>・本番環境ではHTTPSを必須とする |
| ログ記録 | ・商品詳細閲覧操作をログに記録<br>・誰が（user_id）いつ（timestamp）どの商品（product_id）を閲覧したかを記録<br>・削除操作は特に詳細にログ記録 |
| 監査証跡 | ・削除操作の履歴を記録<br>・削除実行者、削除日時、削除理由を記録 |

### 6.3 XSS対策

| 項目 | 対策内容 |
|------|---------|
| 出力エスケープ | ・Thymeleafのエスケープ機能を使用<br>・商品名、商品説明など全てのユーザー入力値をエスケープ処理<br>・HTMLタグをそのまま表示 |

### 6.4 アクセス制御

| 項目 | 対策内容 |
|------|---------|
| URL直接アクセス防止 | ・管理者権限チェックをフィルタで実施<br>・権限がない場合は403エラー |
| パラメータ改ざん対策 | ・商品IDの存在チェック<br>・削除済み商品へのアクセス制御 |

---

## 7. レイアウト

### 7.1 画面構成

```
+--------------------------------------------------+
| ナビゲーションバー (管理者用・固定)                  |
| [🛡️ 商品在庫管理システム 管理者]                  |
| [在庫管理] [商品管理*] [ユーザー管理] [メニュー] [ログアウト] |
+--------------------------------------------------+
| メインコンテンツエリア                              |
| +----------------------------------------------+ |
| | パンくずリスト                                 | |
| | ホーム > 商品管理 > 商品詳細                   | |
| +----------------------------------------------+ |
| | ヘッダー部分                                   | |
| | [商品詳細]            [編集] [削除]            | |
| +----------------------------------------------+ |
| | 基本情報カード                                 | |
| | +------------------------------------------+ | |
| | | 商品ID         | 93TGNAY7                | | |
| | | 商品名         | Laptop                  | | |
| | | カテゴリ       | [Home Appliances]       | | |
| | | SKU            | 8NMFZ4                  | | |
| | | 商品説明       | Product_XU5QX           | | |
| | +------------------------------------------+ | |
| | | 価格           | ¥253.17                 | | |
| | | 在庫数         | ⚠️ 3個                   | | |
| | | ステータス     | [販売中]                | | |
| | | 商品評価       | ⭐⭐⭐☆☆ 2.0 / 5.0     | | |
| | +------------------------------------------+ | |
| +----------------------------------------------+ |
| | 詳細情報カード                                 | |
| | +------------------------------------------+ | |
| | | 保証期間       | 2年                     | | |
| | | 商品寸法       | 16x15x15 cm             | | |
| | | 色/サイズ      | [Green/Large]           | | |
| | +------------------------------------------+ | |
| | | 製造日         | 2023-01-01              | | |
| | | 有効期限       | 2026-01-01              | | |
| | | 商品タグ       | [VNU] [NZ6]             | | |
| | +------------------------------------------+ | |
| +----------------------------------------------+ |
| | 入出庫履歴カード                               | |
| | +------------------------------------------+ | |
| | | 日時        種別  数量  在庫数  担当者  備考 | | |
| | | 2026-02-01  [入庫] +50   53    山田太郎 定期 | | |
| | | 2026-01-31  [出庫] -20    3    佐藤花子 販売 | | |
| | | 2026-01-30  [入庫] +23   23    山田太郎 初期 | | |
| | +------------------------------------------+ | |
| | |              [すべての履歴を表示]          | | |
| | +------------------------------------------+ | |
| +----------------------------------------------+ |
| | アクションボタン                               | |
| | [商品一覧に戻る]                               | |
| +----------------------------------------------+ |
+--------------------------------------------------+
```

### 7.2 レスポンシブデザイン

| デバイス | レイアウト |
|---------|----------|
| デスクトップ（1200px以上） | ・フル幅表示<br>・基本情報は2列レイアウト<br>・詳細情報は2列レイアウト |
| タブレット（768px-1199px） | ・幅調整<br>・基本情報は2列維持<br>・詳細情報は2列維持 |
| モバイル（767px以下） | ・単列表示<br>・基本情報は1列レイアウト<br>・詳細情報は1列レイアウト<br>・テーブルはスクロール表示 |

### 7.3 カラーテーマ

| 要素 | カラー | 備考 |
|-----|--------|------|
| ナビゲーションバー | 青系（管理者用） | navbar-custom-admin |
| 管理者バッジ | 赤 | badge admin-badge |
| 基本情報カードヘッダー | 青 | bg-primary text-white |
| 詳細情報カードヘッダー | グレー | bg-secondary text-white |
| 入出庫履歴カードヘッダー | 水色 | bg-info text-white |
| 編集ボタン | 青 | btn-primary |
| 削除ボタン | 赤（アウトライン） | btn-outline-danger |
| 商品一覧に戻るボタン | グレー | btn-secondary |
| 価格表示 | 青 | text-primary |
| 在庫切れ | 赤 | stock-alert |
| 在庫不足 | オレンジ | stock-warning |
| 入庫Badge | 緑 | bg-success |
| 出庫Badge | 赤 | bg-danger |
| カテゴリBadge | Electronics：青<br>Clothing：水色<br>Home Appliances：グレー | bg-primary / bg-info / bg-secondary |

### 7.4 アイコン使用

| 機能 | アイコン | Bootstrap Icon |
|-----|---------|----------------|
| 商品詳細 | 📦 | bi-box-seam |
| 編集 | ✏️ | bi-pencil |
| 削除 | 🗑️ | bi-trash |
| 基本情報 | ℹ️ | bi-info-circle |
| 詳細情報 | 📋 | bi-list-ul |
| 入出庫履歴 | 🕐 | bi-clock-history |
| すべての履歴 | 📝 | bi-list-task |
| 戻る | ⬅️ | bi-arrow-left |
| 警告 | ⚠️ | bi-exclamation-triangle |
| 在庫切れ | ❌ | bi-x-circle-fill |
| 在庫不足 | ⚠️ | bi-exclamation-triangle-fill |
| 星（塗りつぶし） | ⭐ | bi-star-fill |
| 星（半分） | ⭐ | bi-star-half |
| 星（空） | ☆ | bi-star |

---

## 8. 使用技術

### 8.1 フロントエンド

| 技術 | バージョン | 用途 |
|-----|-----------|------|
| HTML5 | - | マークアップ |
| CSS3 | - | スタイリング |
| JavaScript | ES6+ | クライアントサイド処理<br>モーダル制御 |
| Bootstrap | 5.2.3 | UIフレームワーク<br>レスポンシブデザイン |
| Bootstrap Icons | 1.10.0 | アイコン表示 |

### 8.2 バックエンド

| 技術 | バージョン | 用途 |
|-----|-----------|------|
| Java | 17 | プログラミング言語 |
| Spring Boot | 3.x | フレームワーク |
| Spring Security | 6.x | 認証・認可 |
| Spring Data JPA | 3.x | データアクセス |
| Thymeleaf | 3.x | テンプレートエンジン |

### 8.3 データベース

| 技術 | バージョン | 用途 |
|-----|-----------|------|
| PostgreSQL / MySQL | 14+ / 8+ | リレーショナルデータベース |

### 8.4 ライブラリ

| ライブラリ | 用途 |
|-----------|------|
| Lombok | ボイラープレートコード削減 |
| Apache Commons Lang | ユーティリティ（文字列処理など） |

---

## 9. データ仕様

### 9.1 商品マスタテーブル（products）

| カラム名 | データ型 | NULL | デフォルト値 | 備考 |
|---------|---------|------|------------|------|
| product_id | VARCHAR(8) | NOT NULL | - | 主キー、8文字の英数字 |
| product_name | VARCHAR(100) | NOT NULL | - | 商品名 |
| category | VARCHAR(50) | NOT NULL | - | カテゴリ（Electronics/Clothing/Home Appliances） |
| sku | VARCHAR(50) | NULL | NULL | SKU、一意制約 |
| price | DECIMAL(12,2) | NOT NULL | 0.00 | 価格（円） |
| stock | INTEGER | NOT NULL | 0 | 在庫数 |
| status | VARCHAR(20) | NOT NULL | 'active' | ステータス（active/inactive） |
| description | TEXT | NULL | NULL | 商品説明 |
| rating | DECIMAL(2,1) | NULL | NULL | 商品評価（0.0〜5.0） |
| warranty_months | INTEGER | NULL | NULL | 保証期間（ヶ月） |
| dimensions | VARCHAR(100) | NULL | NULL | 商品寸法 |
| variations | VARCHAR(200) | NULL | NULL | 色/サイズバリエーション |
| manufacturing_date | DATE | NULL | NULL | 製造日 |
| expiration_date | DATE | NULL | NULL | 有効期限 |
| tags | VARCHAR(200) | NULL | NULL | 商品タグ（カンマ区切り） |
| created_at | TIMESTAMP | NOT NULL | CURRENT_TIMESTAMP | 登録日時 |
| updated_at | TIMESTAMP | NOT NULL | CURRENT_TIMESTAMP | 更新日時 |
| deleted_at | TIMESTAMP | NULL | NULL | 削除日時（論理削除） |

### 9.2 在庫履歴テーブル（stock_transactions）

| カラム名 | データ型 | NULL | デフォルト値 | 備考 |
|---------|---------|------|------------|------|
| transaction_id | BIGINT | NOT NULL | AUTO_INCREMENT | 主キー |
| product_id | VARCHAR(8) | NOT NULL | - | 外部キー（products.product_id） |
| transaction_type | VARCHAR(20) | NOT NULL | - | 'IN'（入庫）、'OUT'（出庫）、'ADJUST'（調整） |
| quantity | INTEGER | NOT NULL | - | 数量 |
| before_stock | INTEGER | NOT NULL | - | 変更前在庫数 |
| after_stock | INTEGER | NOT NULL | - | 変更後在庫数 |
| user_id | BIGINT | NOT NULL | - | 実行ユーザーID |
| user_name | VARCHAR(100) | NOT NULL | - | 実行ユーザー名 |
| note | VARCHAR(255) | NULL | NULL | 備考 |
| transaction_date | TIMESTAMP | NOT NULL | CURRENT_TIMESTAMP | 取引日時 |

### 9.3 カテゴリマスタ

| カテゴリ値 | 表示名 | 表示色 |
|-----------|--------|--------|
| Electronics | Electronics | bg-primary（青） |
| Clothing | Clothing | bg-info（水色） |
| Home Appliances | Home Appliances | bg-secondary（グレー） |

### 9.4 ステータスマスタ

| ステータス値 | 表示名 | 表示色 |
|-----------|--------|--------|
| active | 販売中 | badge-status-active（緑） |
| inactive | 販売停止 | badge-status-inactive（グレー） |
| deleted | 削除済み | badge-status-deleted（赤） |

### 9.5 取引種別マスタ

| 種別値 | 表示名 | 表示色 |
|-------|--------|--------|
| IN | 入庫 | bg-success（緑） |
| OUT | 出庫 | bg-danger（赤） |
| ADJUST | 調整 | bg-warning（黄） |

### 9.6 データ取得仕様

| 取得内容 | 取得方法 |
|---------|---------|
| 商品詳細情報 | ・URLパラメータのproductIdで検索<br>・deleted_atがNULLの商品のみ取得<br>・1件取得 |
| 入出庫履歴 | ・商品IDで検索<br>・transaction_date降順でソート<br>・最新3件を取得<br>・ユーザー名も結合して取得 |

---

## 10. 補足事項

### 10.1 商品管理画面との連携
- 商品詳細画面は商品管理画面から遷移
- 商品一覧の商品名クリックで詳細画面を表示
- 詳細画面から一覧画面に戻る機能あり

### 10.2 編集画面との連携
- 詳細画面から編集画面へ遷移可能
- 編集完了後は詳細画面にリダイレクト
- 編集成功時は成功メッセージを表示

### 10.3 履歴画面との連携
- 詳細画面では直近3件のみ表示
- 「すべての履歴を表示」で全履歴画面へ遷移
- 履歴画面ではフィルタリングやCSVエクスポート可能

### 10.4 今後の拡張予定
- 商品画像の表示機能
- 商品のQRコード表示機能
- 商品の関連商品表示機能
- 商品のレビュー・コメント表示機能
- 商品の販売実績グラフ表示機能
- 印刷用レイアウトの提供

### 10.5 ユーザビリティ考慮
- 基本情報と詳細情報を分けて表示し、一覧性を向上
- 在庫状態を色とアイコンで視覚的に表示
- 直近の履歴を表示し、商品の動きを把握しやすくする
- ページヘッダーにアクションボタンを配置し、操作性を向上
- パンくずリストで現在位置を明示

### 10.6 パフォーマンス考慮
- 商品情報と履歴情報を効率的に取得
- 履歴は直近3件のみ取得し、パフォーマンスを向上
- インデックスの適切な設定
- N+1問題を回避するためのJOIN最適化

### 10.7 アクセシビリティ考慮
- セマンティックHTMLの使用
- 適切なaria属性の設定
- キーボード操作への対応
- スクリーンリーダー対応

---

**文書管理情報**
- **作成者**：システム管理者
- **承認者**：プロジェクトマネージャー
- **配布先**：開発チーム全員
- **更新履歴**：
  - 2026年2月4日：初版作成
