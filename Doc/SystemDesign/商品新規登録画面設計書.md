# 商品新規登録画面設計書

## 目次
- [1. 基本情報](#1-基本情報)
- [2. 画面概要](#2-画面概要)
- [3. UI要素一覧](#3-ui要素一覧)
- [4. 機能仕様](#4-機能仕様)
- [5. バリデーション](#5-バリデーション)
- [6. セキュリティ](#6-セキュリティ)
- [7. レイアウト](#7-レイアウト)
- [8. 使用技術](#8-使用技術)
- [9. データ仕様](#9-データ仕様)

---

## 1. 基本情報

| 項目 | 内容 |
|------|------|
| 画面ID | PROD-CREATE-001 |
| 画面名 | 商品新規登録画面 |
| URL | /admin/products/create |
| アクセス権限 | 管理者のみ |
| 作成日 | 2026年2月4日 |
| 更新日 | 2026年2月4日 |

---

## 2. 画面概要

管理者が新しい商品を1件ずつ登録するための専用画面です。基本情報（必須）と詳細情報（任意）を分けて入力でき、直感的で使いやすいフォームデザインを提供します。入力内容はクライアントサイドとサーバーサイドの両方でバリデーションされ、データの正確性を保証します。

### 主な機能
- 商品の新規登録（1件ずつ）
- 基本情報の入力（必須項目）
- 詳細情報の入力（任意項目）
- リアルタイムバリデーション
- SKU自動生成（オプション）
- 入力内容の確認とキャンセル機能

### 画面の特徴
- **段階的な入力フロー**：基本情報→詳細情報の順で入力
- **わかりやすいUI**：必須項目と任意項目を明確に区別
- **親切なガイダンス**：各項目にプレースホルダーと説明文を表示
- **即座のフィードバック**：入力エラーをリアルタイムで表示

---

## 3. UI要素一覧

### 3.1 ナビゲーションバー（管理者用）

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 1 | ロゴ/リンク | システム名 | link | - | 「商品在庫管理システム」<br>/admin/menuへ遷移<br>管理者バッジ表示 |
| 2 | ナビゲーションリンク | 在庫管理 | link | - | /admin/inventoryへ遷移<br>アイコン：bi-clipboard-data |
| 3 | ナビゲーションリンク | 商品管理 | link | - | /admin/productsへ遷移<br>アイコン：bi-box-seam<br>現在地：active状態 |
| 4 | ナビゲーションリンク | ユーザー管理 | link | - | /admin/usersへ遷移<br>アイコン：bi-people |
| 5 | ナビゲーションリンク | メニュー | link | - | /admin/menuへ遷移<br>アイコン：bi-house |
| 6 | ボタン | ログアウト | submit | - | /logoutへPOST送信<br>アイコン：bi-box-arrow-right |

### 3.2 パンくずリスト

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 7 | リンク | ホーム | link | - | /admin/menuへ遷移 |
| 8 | リンク | 商品管理 | link | - | /admin/productsへ遷移 |
| 9 | テキスト | 商品新規登録 | text | - | 現在地（非リンク） |

### 3.3 ページヘッダー

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 10 | 見出し | ページタイトル | - | - | 「商品新規登録」<br>アイコン：bi-plus-circle |

### 3.4 基本情報カード

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 11 | カードヘッダー | セクションタイトル | - | - | 「基本情報」<br>アイコン：bi-info-circle<br>スタイル：bg-primary text-white |
| 12 | 入力欄 | 商品名 | text | 必須 | プレースホルダー：「例: Laptop Pro 15」<br>最大100文字<br>required属性 |
| 13 | セレクトボックス | カテゴリ | select | 必須 | オプション：<br>- 選択してください<br>- Electronics<br>- Clothing<br>- Home Appliances<br>required属性 |
| 14 | 入力欄 | SKU | text | 任意 | プレースホルダー：「例: LAP-PRO-15」<br>最大50文字<br>空欄の場合は自動生成 |
| 15 | 入力欄 | 価格 | number | 必須 | プレースホルダー：「例: 89900」<br>0以上<br>小数点2桁まで<br>required属性 |
| 16 | 入力欄 | 初期在庫数 | number | 必須 | プレースホルダー：「例: 50」<br>0以上の整数<br>required属性 |
| 17 | セレクトボックス | ステータス | select | 必須 | オプション：<br>- 販売中(active)<br>- 販売停止(inactive)<br>デフォルト：販売中<br>required属性 |
| 18 | 入力欄 | 商品説明 | textarea | 任意 | プレースホルダー：「商品の詳細説明を入力してください」<br>最大500文字<br>行数：3行 |

### 3.5 詳細情報カード（任意）

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 19 | カードヘッダー | セクションタイトル | - | - | 「詳細情報（任意）」<br>アイコン：bi-list-ul<br>スタイル：bg-secondary text-white |
| 20 | 入力欄 | 保証期間 | number | 任意 | プレースホルダー：「例: 12」<br>単位：ヶ月<br>0以上の整数 |
| 21 | 入力欄 | 商品寸法 | text | 任意 | プレースホルダー：「例: 35.5 x 24.0 x 1.8 cm」<br>最大100文字 |
| 22 | 入力欄 | 色/サイズバリエーション | text | 任意 | プレースホルダー：「例: シルバー, ブラック / 13インチ, 15インチ」<br>最大200文字 |
| 23 | 入力欄 | 製造日 | date | 任意 | 日付選択 |
| 24 | 入力欄 | 有効期限 | date | 任意 | 日付選択<br>製造日より後の日付のみ |
| 25 | 入力欄 | 商品タグ | text | 任意 | プレースホルダー：「例: 人気, 新商品, セール」<br>カンマ区切り<br>最大200文字 |

### 3.6 フォームアクション

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 26 | ボタングループ | アクション | - | - | 画面下部に配置 |
| 27 | ボタン | キャンセルボタン | button | - | /admin/productsへ遷移<br>アイコン：bi-x-circle<br>スタイル：btn-secondary btn-lg<br>ラベル：「キャンセル」 |
| 28 | ボタン | 登録ボタン | submit | - | フォーム送信<br>アイコン：bi-check-circle<br>スタイル：btn-primary btn-lg<br>ラベル：「登録する」 |

### 3.7 バリデーションメッセージ

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 29 | エラーメッセージ | 商品名エラー | text | - | 「商品名を入力してください」<br>スタイル：invalid-feedback |
| 30 | エラーメッセージ | カテゴリエラー | text | - | 「カテゴリを選択してください」<br>スタイル：invalid-feedback |
| 31 | エラーメッセージ | 価格エラー | text | - | 「価格を入力してください」<br>スタイル：invalid-feedback |
| 32 | エラーメッセージ | 在庫数エラー | text | - | 「在庫数を入力してください」<br>スタイル：invalid-feedback |
| 33 | ヘルプテキスト | SKU説明 | text | - | 「空欄の場合は自動生成されます」<br>スタイル：text-muted |
| 34 | ヘルプテキスト | 説明文字数 | text | - | 「最大500文字」<br>スタイル：text-muted |

---

## 4. 機能仕様

### 4.1 画面表示機能

#### 4.1.1 初期表示
- **処理概要**：商品新規登録フォームを初期状態で表示
- **表示内容**：
  - ナビゲーションバー
  - パンくずリスト
  - ページヘッダー
  - 基本情報入力フォーム（空欄）
  - 詳細情報入力フォーム（空欄）
  - フォームアクションボタン
- **初期値設定**：
  - ステータス：販売中（active）を選択
  - その他の項目：空欄

#### 4.1.2 パンくずリスト表示
- **表示内容**：ホーム > 商品管理 > 商品新規登録
- **リンク機能**：
  - ホーム：/admin/menuへ遷移
  - 商品管理：/admin/productsへ遷移
  - 商品新規登録：現在地（非リンク）

### 4.2 入力機能

#### 4.2.1 基本情報入力
- **商品名**：
  - 入力形式：テキスト
  - 制約：必須、最大100文字
  - プレースホルダー：「例: Laptop Pro 15」
  - バリデーション：リアルタイム
- **カテゴリ**：
  - 入力形式：セレクトボックス
  - 制約：必須
  - 選択肢：Electronics、Clothing、Home Appliances
- **SKU**：
  - 入力形式：テキスト
  - 制約：任意、最大50文字
  - プレースホルダー：「例: LAP-PRO-15」
  - 自動生成：空欄の場合はサーバー側で自動生成
- **価格**：
  - 入力形式：数値（number）
  - 制約：必須、0以上、小数点2桁まで
  - プレースホルダー：「例: 89900」
  - フォーマット：blur時に小数点2桁に整形
- **初期在庫数**：
  - 入力形式：数値（number）
  - 制約：必須、0以上の整数
  - プレースホルダー：「例: 50」
- **ステータス**：
  - 入力形式：セレクトボックス
  - 制約：必須
  - 選択肢：販売中(active)、販売停止(inactive)
  - デフォルト：販売中
- **商品説明**：
  - 入力形式：テキストエリア
  - 制約：任意、最大500文字
  - プレースホルダー：「商品の詳細説明を入力してください」
  - 行数：3行

#### 4.2.2 詳細情報入力（任意）
- **保証期間**：
  - 入力形式：数値（number）
  - 制約：任意、0以上の整数
  - 単位：ヶ月
- **商品寸法**：
  - 入力形式：テキスト
  - 制約：任意、最大100文字
  - 例：「35.5 x 24.0 x 1.8 cm」
- **色/サイズバリエーション**：
  - 入力形式：テキスト
  - 制約：任意、最大200文字
  - 例：「シルバー, ブラック / 13インチ, 15インチ」
- **製造日**：
  - 入力形式：日付（date）
  - 制約：任意
- **有効期限**：
  - 入力形式：日付（date）
  - 制約：任意、製造日より後の日付
  - バリデーション：製造日との整合性チェック
- **商品タグ**：
  - 入力形式：テキスト
  - 制約：任意、最大200文字
  - フォーマット：カンマ区切り
  - 例：「人気, 新商品, セール」

### 4.3 バリデーション機能

#### 4.3.1 クライアントサイドバリデーション
- **実行タイミング**：
  - リアルタイム：入力中・blur時
  - 送信時：登録ボタン押下時
- **バリデーション項目**：
  - 必須項目チェック
  - 文字数制限チェック
  - 数値範囲チェック
  - 日付整合性チェック
- **エラー表示**：
  - 入力欄の枠を赤色で表示
  - エラーメッセージを入力欄下部に表示
  - was-validatedクラスを適用
- **成功表示**：
  - 入力欄の枠を緑色で表示
  - チェックマークアイコンを表示

#### 4.3.2 サーバーサイドバリデーション
- **実行タイミング**：フォーム送信後
- **バリデーション項目**：
  - クライアント側と同じチェック
  - SKU重複チェック
  - データベース制約チェック
- **エラーハンドリング**：
  - エラー発生時は入力画面に戻る
  - エラーメッセージを表示
  - 入力値を保持

### 4.4 登録処理機能

#### 4.4.1 登録処理フロー
1. **バリデーション実行**：
   - クライアントサイドバリデーション
   - エラーがある場合は処理中断
2. **データ送信**：
   - フォームデータをPOSTで送信
   - CSRF トークンを含める
3. **サーバー処理**：
   - サーバーサイドバリデーション
   - SKU自動生成（空欄の場合）
   - 商品IDの自動生成
   - データベースへの保存
4. **処理結果**：
   - 成功：商品管理画面へリダイレクト + 成功メッセージ
   - 失敗：入力画面に戻る + エラーメッセージ

#### 4.4.2 SKU自動生成
- **生成タイミング**：SKU入力欄が空欄の場合
- **生成ルール**：
  - カテゴリの頭文字 + ランダム英数字
  - 例：Electronics → ELC-XXXXX
  - 重複チェックを実施
- **生成場所**：サーバーサイド

#### 4.4.3 商品ID自動生成
- **生成タイミング**：必ず自動生成
- **生成ルール**：
  - 8文字のランダム英数字（大文字）
  - 重複チェックを実施
- **生成場所**：サーバーサイド

### 4.5 キャンセル機能

#### 4.5.1 キャンセル処理
- **実行方法**：キャンセルボタンをクリック
- **処理内容**：
  - 入力内容を破棄
  - 商品管理画面（/admin/products）へ遷移
- **確認ダイアログ**：
  - 入力内容がある場合は確認ダイアログを表示（推奨）
  - 「入力内容が失われますがよろしいですか？」

### 4.6 価格フォーマット機能

#### 4.6.1 価格入力のフォーマット
- **実行タイミング**：価格入力欄からフォーカスが外れた時（blur時）
- **処理内容**：
  - 入力値を小数点2桁にフォーマット
  - 例：89900 → 89900.00
- **実装場所**：JavaScript

### 4.7 日付整合性チェック機能

#### 4.7.1 製造日と有効期限のチェック
- **実行タイミング**：有効期限が変更された時
- **チェック内容**：
  - 有効期限 > 製造日
  - 違反する場合はアラート表示
  - 有効期限をクリア
- **アラートメッセージ**：「有効期限は製造日より後の日付を設定してください」

### 4.8 画面遷移機能

#### 4.8.1 商品管理画面への遷移
- **遷移方法**：
  - パンくずリストの「商品管理」をクリック
  - キャンセルボタンをクリック
- **遷移先**：/admin/products

#### 4.8.2 管理者メニューへの遷移
- **遷移方法**：
  - ナビゲーションバーのシステム名をクリック
  - パンくずリストの「ホーム」をクリック
- **遷移先**：/admin/menu

#### 4.8.3 他の管理画面への遷移
- **在庫管理**：/admin/inventory
- **ユーザー管理**：/admin/users

#### 4.8.4 ログアウト
- **実行方法**：ナビゲーションバーの「ログアウト」ボタンをクリック
- **処理**：/logoutへPOST送信
- **遷移先**：ログイン画面（/admin/login）

---

## 5. バリデーション

### 5.1 基本情報バリデーション

| 項目 | バリデーション内容 |
|------|-------------------|
| 商品名 | ・必須入力<br>・最大文字数：100文字<br>・空白のみの入力不可 |
| カテゴリ | ・必須選択<br>・選択肢：Electronics、Clothing、Home Appliances<br>・「選択してください」のままでは登録不可 |
| SKU | ・任意入力<br>・最大文字数：50文字<br>・既存のSKUと重複不可<br>・空欄の場合は自動生成 |
| 価格 | ・必須入力<br>・数値のみ入力可能<br>・0以上の数値<br>・小数点2桁まで<br>・最大値：999,999,999.99円 |
| 初期在庫数 | ・必須入力<br>・数値のみ入力可能<br>・0以上の整数<br>・最大値：999,999個 |
| ステータス | ・必須選択<br>・選択肢：販売中(active)、販売停止(inactive)<br>・デフォルト：販売中 |
| 商品説明 | ・任意入力<br>・最大文字数：500文字 |

### 5.2 詳細情報バリデーション

| 項目 | バリデーション内容 |
|------|-------------------|
| 保証期間 | ・任意入力<br>・数値のみ入力可能<br>・0以上の整数<br>・最大値：999ヶ月 |
| 商品寸法 | ・任意入力<br>・最大文字数：100文字 |
| 色/サイズバリエーション | ・任意入力<br>・最大文字数：200文字 |
| 製造日 | ・任意入力<br>・有効な日付形式 |
| 有効期限 | ・任意入力<br>・有効な日付形式<br>・製造日より後の日付のみ<br>・製造日が入力されている場合のみチェック |
| 商品タグ | ・任意入力<br>・最大文字数：200文字<br>・カンマ区切り |

### 5.3 エラーメッセージ

| エラー種別 | メッセージ内容 |
|-----------|---------------|
| 商品名未入力 | 「商品名を入力してください」 |
| 商品名文字数超過 | 「商品名は100文字以内で入力してください」 |
| カテゴリ未選択 | 「カテゴリを選択してください」 |
| SKU文字数超過 | 「SKUは50文字以内で入力してください」 |
| SKU重複 | 「SKU「{SKU}」は既に使用されています」 |
| 価格未入力 | 「価格を入力してください」 |
| 価格が数値でない | 「価格は数値で入力してください」 |
| 価格が負の値 | 「価格は0以上で入力してください」 |
| 価格が最大値超過 | 「価格は999,999,999.99円以下で入力してください」 |
| 在庫数未入力 | 「在庫数を入力してください」 |
| 在庫数が数値でない | 「在庫数は数値で入力してください」 |
| 在庫数が負の値 | 「在庫数は0以上で入力してください」 |
| 在庫数が最大値超過 | 「在庫数は999,999個以下で入力してください」 |
| 説明文字数超過 | 「商品説明は500文字以内で入力してください」 |
| 有効期限が製造日以前 | 「有効期限は製造日より後の日付を設定してください」 |
| 商品タグ文字数超過 | 「商品タグは200文字以内で入力してください」 |
| 権限エラー | 「この操作を実行する権限がありません」 |
| システムエラー | 「システムエラーが発生しました。管理者に連絡してください」 |

### 5.4 バリデーションタイミング

| タイミング | 実行内容 |
|-----------|---------|
| リアルタイム | ・文字数カウント<br>・入力形式チェック |
| blur時 | ・必須項目チェック<br>・数値範囲チェック<br>・価格フォーマット |
| 送信時 | ・全項目の総合チェック<br>・クライアントサイドバリデーション |
| サーバー処理時 | ・全項目の再チェック<br>・重複チェック<br>・データベース制約チェック |

---

## 6. セキュリティ

### 6.1 認証・認可

| 項目 | 対策内容 |
|------|---------|
| 認証 | ・管理者ログイン認証必須<br>・未認証ユーザーは管理者ログイン画面へリダイレクト |
| 認可 | ・管理者権限チェック<br>・一般ユーザーがアクセスした場合は403エラー |
| セッション管理 | ・Spring Securityによるセッション管理<br>・セッションタイムアウト：30分<br>・管理者専用セッション |
| CSRF対策 | ・POSTリクエストでCSRFトークン検証を実施<br>・フォーム送信時に必須 |

### 6.2 入力値検証

| 項目 | 対策内容 |
|------|---------|
| XSS対策 | ・Thymeleafのエスケープ機能を使用<br>・ユーザー入力値（商品名、説明など）を全てエスケープ処理 |
| SQLインジェクション対策 | ・PreparedStatementを使用<br>・JPAのパラメータバインディングを使用<br>・動的SQLは使用しない |
| パラメータ改ざん対策 | ・サーバーサイドでの入力値検証を実施<br>・価格、在庫数などの改ざんチェック<br>・権限チェック（管理者のみ実行可能） |

### 6.3 データ保護

| 項目 | 対策内容 |
|------|---------|
| 通信暗号化 | ・HTTPS通信を推奨<br>・本番環境ではHTTPSを必須とする |
| ログ記録 | ・商品登録操作をログに記録<br>・誰が（user_id）いつ（timestamp）何を（商品ID、商品名）登録したかを記録<br>・管理者操作ログを別途記録 |
| 監査証跡 | ・商品マスタの登録履歴を記録<br>・初期在庫数も記録（在庫履歴テーブルに記録） |

### 6.4 アクセス制御

| 項目 | 対策内容 |
|------|---------|
| URL直接アクセス防止 | ・管理者権限チェックをフィルタで実施<br>・権限がない場合は403エラー |
| 画面表示制御 | ・管理者専用機能は権限チェック後に表示<br>・一般ユーザーには表示しない |

---

## 7. レイアウト

### 7.1 画面構成

```
+--------------------------------------------------+
| ナビゲーションバー (管理者用・固定)                  |
| [🛡️ 商品在庫管理システム 管理者]                  |
| [在庫管理] [商品管理*] [ユーザー管理] [メニュー] [ログアウト] |
+--------------------------------------------------+
| メインコンテンツエリア                              |
| +----------------------------------------------+ |
| | パンくずリスト                                 | |
| | ホーム > 商品管理 > 商品新規登録                | |
| +----------------------------------------------+ |
| | ヘッダー部分                                   | |
| | [商品新規登録]                                 | |
| +----------------------------------------------+ |
| | 基本情報カード                                 | |
| | +------------------------------------------+ | |
| | | 商品名 [必須] [__________________]        | | |
| | | カテゴリ [必須] [選択▼]                   | | |
| | | SKU [任意] [__________________]           | | |
| | | 価格 [必須] [__________________]          | | |
| | | 初期在庫数 [必須] [__________________]     | | |
| | | ステータス [必須] [販売中▼]               | | |
| | | 商品説明 [任意] [__________________]       | | |
| | +------------------------------------------+ | |
| +----------------------------------------------+ |
| | 詳細情報カード（任意）                          | |
| | +------------------------------------------+ | |
| | | 保証期間 [__________] ヶ月                | | |
| | | 商品寸法 [__________________]             | | |
| | | 色/サイズ [__________________]            | | |
| | | 製造日 [____/__/__]                       | | |
| | | 有効期限 [____/__/__]                     | | |
| | | 商品タグ [__________________]             | | |
| | +------------------------------------------+ | |
| +----------------------------------------------+ |
| | フォームアクション                             | |
| | [キャンセル]               [登録する]         | |
| +----------------------------------------------+ |
+--------------------------------------------------+
```

### 7.2 レスポンシブデザイン

| デバイス | レイアウト |
|---------|----------|
| デスクトップ（1200px以上） | ・フル幅表示<br>・基本情報は2列レイアウト<br>・詳細情報は2列レイアウト |
| タブレット（768px-1199px） | ・幅調整<br>・基本情報は2列維持<br>・詳細情報は2列維持 |
| モバイル（767px以下） | ・単列表示<br>・基本情報は1列レイアウト<br>・詳細情報は1列レイアウト |

### 7.3 カラーテーマ

| 要素 | カラー | 備考 |
|-----|--------|------|
| ナビゲーションバー | 青系（管理者用） | navbar-custom-admin |
| 管理者バッジ | 赤 | badge admin-badge |
| 基本情報カードヘッダー | 青 | bg-primary text-white |
| 詳細情報カードヘッダー | グレー | bg-secondary text-white |
| 登録ボタン | 青 | btn-primary btn-lg |
| キャンセルボタン | グレー | btn-secondary btn-lg |
| エラー表示 | 赤 | invalid-feedback |
| 成功表示 | 緑 | valid-feedback |
| ヘルプテキスト | グレー | text-muted |

### 7.4 アイコン使用

| 機能 | アイコン | Bootstrap Icon |
|-----|---------|----------------|
| 商品新規登録 | ➕ | bi-plus-circle |
| 基本情報 | ℹ️ | bi-info-circle |
| 詳細情報 | 📋 | bi-list-ul |
| 登録 | ✅ | bi-check-circle |
| キャンセル | ❌ | bi-x-circle |
| 必須マーク | * | - |

---

## 8. 使用技術

### 8.1 フロントエンド

| 技術 | バージョン | 用途 |
|-----|-----------|------|
| HTML5 | - | マークアップ |
| CSS3 | - | スタイリング |
| JavaScript | ES6+ | クライアントサイド処理<br>バリデーション<br>フォーマット処理 |
| Bootstrap | 5.2.3 | UIフレームワーク<br>レスポンシブデザイン |
| Bootstrap Icons | 1.10.0 | アイコン表示 |

### 8.2 バックエンド

| 技術 | バージョン | 用途 |
|-----|-----------|------|
| Java | 17 | プログラミング言語 |
| Spring Boot | 3.x | フレームワーク |
| Spring Security | 6.x | 認証・認可 |
| Spring Data JPA | 3.x | データアクセス |
| Thymeleaf | 3.x | テンプレートエンジン |
| Bean Validation | 3.x | サーバーサイドバリデーション |

### 8.3 データベース

| 技術 | バージョン | 用途 |
|-----|-----------|------|
| PostgreSQL / MySQL | 14+ / 8+ | リレーショナルデータベース |

### 8.4 ライブラリ

| ライブラリ | 用途 |
|-----------|------|
| Lombok | ボイラープレートコード削減 |
| Validation API | バリデーション |
| Apache Commons Lang | ユーティリティ（文字列処理など） |

---

## 9. データ仕様

### 9.1 商品マスタテーブル（products）

| カラム名 | データ型 | NULL | デフォルト値 | 備考 |
|---------|---------|------|------------|------|
| product_id | VARCHAR(8) | NOT NULL | - | 主キー、8文字の英数字、自動生成 |
| product_name | VARCHAR(100) | NOT NULL | - | 商品名 |
| category | VARCHAR(50) | NOT NULL | - | カテゴリ（Electronics/Clothing/Home Appliances） |
| sku | VARCHAR(50) | NULL | NULL | SKU、空欄の場合は自動生成、一意制約 |
| price | DECIMAL(12,2) | NOT NULL | 0.00 | 価格（円） |
| stock | INTEGER | NOT NULL | 0 | 在庫数 |
| status | VARCHAR(20) | NOT NULL | 'active' | ステータス（active/inactive） |
| description | TEXT | NULL | NULL | 商品説明 |
| warranty_months | INTEGER | NULL | NULL | 保証期間（ヶ月） |
| dimensions | VARCHAR(100) | NULL | NULL | 商品寸法 |
| variations | VARCHAR(200) | NULL | NULL | 色/サイズバリエーション |
| manufacturing_date | DATE | NULL | NULL | 製造日 |
| expiration_date | DATE | NULL | NULL | 有効期限 |
| tags | VARCHAR(200) | NULL | NULL | 商品タグ（カンマ区切り） |
| created_at | TIMESTAMP | NOT NULL | CURRENT_TIMESTAMP | 登録日時 |
| updated_at | TIMESTAMP | NOT NULL | CURRENT_TIMESTAMP | 更新日時 |
| deleted_at | TIMESTAMP | NULL | NULL | 削除日時（論理削除） |

### 9.2 在庫履歴テーブル（stock_transactions）

| カラム名 | データ型 | NULL | デフォルト値 | 備考 |
|---------|---------|------|------------|------|
| transaction_id | BIGINT | NOT NULL | AUTO_INCREMENT | 主キー |
| product_id | VARCHAR(8) | NOT NULL | - | 外部キー（products.product_id） |
| transaction_type | VARCHAR(20) | NOT NULL | - | 'IN'（入庫）、'OUT'（出庫）、'ADJUST'（調整） |
| quantity | INTEGER | NOT NULL | - | 数量 |
| before_stock | INTEGER | NOT NULL | - | 変更前在庫数 |
| after_stock | INTEGER | NOT NULL | - | 変更後在庫数 |
| user_id | BIGINT | NOT NULL | - | 実行ユーザーID |
| note | VARCHAR(255) | NULL | NULL | 備考 |
| transaction_date | TIMESTAMP | NOT NULL | CURRENT_TIMESTAMP | 取引日時 |

### 9.3 カテゴリマスタ

| カテゴリ値 | 表示名 | 表示色 | SKUプレフィックス |
|-----------|--------|--------|------------------|
| Electronics | Electronics | bg-primary（青） | ELC |
| Clothing | Clothing | bg-info（水色） | CLO |
| Home Appliances | Home Appliances | bg-secondary（グレー） | HOM |

### 9.4 ステータスマスタ

| ステータス値 | 表示名 | 表示色 |
|-----------|--------|--------|
| active | 販売中 | badge-status-active（緑） |
| inactive | 販売停止 | badge-status-inactive（グレー） |

### 9.5 データ制約

| 項目 | 制約 |
|-----|------|
| 商品ID | ・一意制約<br>・8文字の英数字<br>・大文字推奨<br>・自動生成 |
| 商品名 | ・NOT NULL<br>・最大100文字<br>・空白のみ不可 |
| カテゴリ | ・NOT NULL<br>・有効な値：Electronics, Clothing, Home Appliances |
| SKU | ・一意制約<br>・最大50文字<br>・NULL許可<br>・空欄の場合は自動生成 |
| 価格 | ・NOT NULL<br>・0以上<br>・小数点2桁まで<br>・最大999,999,999.99円 |
| 在庫数 | ・NOT NULL<br>・0以上<br>・最大999,999個 |
| ステータス | ・NOT NULL<br>・有効な値：active, inactive |
| 商品説明 | ・NULL許可<br>・最大500文字 |
| 保証期間 | ・NULL許可<br>・0以上の整数<br>・最大999ヶ月 |
| 商品寸法 | ・NULL許可<br>・最大100文字 |
| 色/サイズバリエーション | ・NULL許可<br>・最大200文字 |
| 製造日 | ・NULL許可<br>・有効な日付 |
| 有効期限 | ・NULL許可<br>・有効な日付<br>・製造日より後の日付 |
| 商品タグ | ・NULL許可<br>・最大200文字<br>・カンマ区切り |

---

## 10. 補足事項

### 10.1 商品管理画面との連携
- 商品新規登録画面は商品管理画面から遷移
- 登録成功後は商品管理画面にリダイレクト
- キャンセル時も商品管理画面に戻る

### 10.2 在庫管理との連携
- 商品登録時の初期在庫数は在庫履歴テーブルにも記録
- トランザクションタイプは'IN'（入庫）として記録
- 在庫管理画面で在庫変動履歴として確認可能

### 10.3 今後の拡張予定
- 商品画像のアップロード機能
- 商品のバーコード生成機能
- 商品テンプレート機能（よく使う商品情報の保存）
- 商品の複製機能（既存商品をベースに新規登録）
- 一時保存機能（入力途中でのデータ保存）

### 10.4 ユーザビリティ考慮
- 必須項目と任意項目を明確に区別
- プレースホルダーで入力例を表示
- ヘルプテキストで補足説明を表示
- リアルタイムバリデーションで即座にフィードバック
- エラー時は具体的なエラーメッセージを表示

### 10.5 パフォーマンス考慮
- クライアントサイドバリデーションでサーバー負荷を軽減
- 必要最小限のデータのみ送信
- インデックスの適切な設定
- トランザクション処理の最適化

---

**文書管理情報**
- **作成者**：システム管理者
- **承認者**：プロジェクトマネージャー
- **配布先**：開発チーム全員
- **更新履歴**：
  - 2026年2月4日：初版作成
