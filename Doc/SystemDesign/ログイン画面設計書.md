# ログイン画面設計書

## 目次
- [1. 一般ユーザーログイン画面](#1-一般ユーザーログイン画面)
- [2. 管理者ログイン画面](#2-管理者ログイン画面)

---

## 1. 一般ユーザーログイン画面

### 基本情報
| 項目 | 内容 |
|------|------|
| 画面ID | USR-001 |
| 画面名 | 一般ユーザーログイン画面 |
| URL | /login |
| アクセス権限 | 全てのユーザー（未認証） |
| 作成日 | 2026年2月3日 |

### 画面概要
一般ユーザーが商品在庫管理システムにログインするための画面です。

### UI要素一覧

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 1 | タイトル | システム名 | - | - | 「商品在庫管理システム」を表示 |
| 2 | タイトル | 画面タイトル | - | - | 「ログイン」を表示 |
| 3 | 入力欄 | ユーザー名 | text | 必須 | ユーザー名を入力<br>プレースホルダー：「ユーザー名を入力」<br>autofocus属性あり |
| 4 | 入力欄 | パスワード | password | 必須 | パスワードを入力（マスク表示）<br>プレースホルダー：「パスワードを入力」 |
| 5 | チェックボックス | ログイン状態を保持する | checkbox | 任意 | チェックONでログイン状態を保持<br>デフォルト：OFF |
| 6 | ボタン | ログインボタン | submit | - | ログイン処理を実行<br>ボタンラベル：「ログイン」<br>スタイル：btn-primary |
| 7 | リンク | 管理者の方はこちら | link | - | /admin/loginへ遷移 |
| 8 | メッセージ | エラーメッセージ | alert-danger | - | ログイン失敗時に表示<br>メッセージ：「ログインに失敗しました。ユーザー名またはパスワードが正しくありません。」 |
| 9 | メッセージ | ログアウトメッセージ | alert-success | - | ログアウト後に表示<br>メッセージ：「ログアウトしました。」 |

### 機能仕様

#### 1. ログイン処理
- ユーザー名とパスワードを入力してログインボタンを押下すると、認証処理を実行
- 認証に成功した場合、商品一覧画面（/products）へ遷移
- 認証に失敗した場合、エラーメッセージを表示してログイン画面に留まる

#### 2. ログイン状態保持
- 「ログイン状態を保持する」にチェックを入れると、ブラウザを閉じても認証情報を保持
- チェックを入れない場合、セッションベースの認証となり、ブラウザを閉じると再ログインが必要

#### 3. 画面遷移
- 「管理者の方はこちら」リンクをクリックすると、管理者ログイン画面（/admin/login）へ遷移
- ログアウト後に遷移した場合、ログアウト完了メッセージを表示

### バリデーション

| 項目 | バリデーション内容 |
|------|-------------------|
| ユーザー名 | ・必須入力<br>・空白のみの入力は不可 |
| パスワード | ・必須入力<br>・空白のみの入力は不可 |

### セキュリティ

| 項目 | 対策内容 |
|------|---------|
| CSRF対策 | トークンによる検証を実施（hidden inputで送信） |
| パスワード表示 | マスク表示（****） |
| エラーメッセージ | 具体的なエラー内容は表示せず、汎用的なメッセージを表示<br>（ユーザー名の存在有無を推測されないため） |
| 通信暗号化 | HTTPS通信を推奨 |

### レイアウト
- レスポンシブデザイン対応（Bootstrap 5.2.3使用）
- 画面中央にログインフォームを配置
- 最大幅：400px程度
- カスタムCSSクラス：`user-login`, `login-container`

### 使用技術
- Thymeleaf（テンプレートエンジン）
- Bootstrap 5.2.3（CSSフレームワーク）
- Spring Security（認証・認可）

---

## 2. 管理者ログイン画面

### 基本情報
| 項目 | 内容 |
|------|------|
| 画面ID | ADM-001 |
| 画面名 | 管理者ログイン画面 |
| URL | /admin/login |
| アクセス権限 | 全てのユーザー（未認証） |
| 作成日 | 2026年2月3日 |

### 画面概要
管理者が商品在庫管理システムにログインするための画面です。

### UI要素一覧

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 1 | タイトル | システム名 | - | - | 「商品在庫管理システム」を表示 |
| 2 | タイトル | 画面タイトル | - | - | 「管理者ログイン」を表示 |
| 3 | 入力欄 | 管理者ユーザー名 | text | 必須 | 管理者ユーザー名を入力<br>プレースホルダー：「管理者ユーザー名を入力」<br>autofocus属性あり |
| 4 | 入力欄 | パスワード | password | 必須 | パスワードを入力（マスク表示）<br>プレースホルダー：「パスワードを入力」 |
| 5 | チェックボックス | ログイン状態を保持する | checkbox | 任意 | チェックONでログイン状態を保持<br>デフォルト：OFF |
| 6 | ボタン | 管理者としてログインボタン | submit | - | 管理者ログイン処理を実行<br>ボタンラベル：「管理者としてログイン」<br>スタイル：btn-primary |
| 7 | リンク | 一般ユーザーの方はこちら | link | - | /loginへ遷移 |
| 8 | メッセージ | エラーメッセージ | alert-danger | - | ログイン失敗時に表示<br>メッセージ：「ログインに失敗しました。管理者ユーザー名またはパスワードが正しくありません。」 |
| 9 | メッセージ | ログアウトメッセージ | alert-success | - | ログアウト後に表示<br>メッセージ：「ログアウトしました。」 |

### 機能仕様

#### 1. ログイン処理
- 管理者ユーザー名とパスワードを入力してログインボタンを押下すると、認証処理を実行
- 認証に成功した場合、管理者メニュー画面（/admin/menu）へ遷移
- 認証に失敗した場合、エラーメッセージを表示してログイン画面に留まる

#### 2. ログイン状態保持
- 「ログイン状態を保持する」にチェックを入れると、ブラウザを閉じても認証情報を保持
- チェックを入れない場合、セッションベースの認証となり、ブラウザを閉じると再ログインが必要

#### 3. 画面遷移
- 「一般ユーザーの方はこちら」リンクをクリックすると、一般ユーザーログイン画面（/login）へ遷移
- ログアウト後に遷移した場合、ログアウト完了メッセージを表示

### バリデーション

| 項目 | バリデーション内容 |
|------|-------------------|
| 管理者ユーザー名 | ・必須入力<br>・空白のみの入力は不可 |
| パスワード | ・必須入力<br>・空白のみの入力は不可 |

### セキュリティ

| 項目 | 対策内容 |
|------|---------|
| CSRF対策 | トークンによる検証を実施（hidden inputで送信） |
| パスワード表示 | マスク表示（****） |
| エラーメッセージ | 具体的なエラー内容は表示せず、汎用的なメッセージを表示<br>（ユーザー名の存在有無を推測されないため） |
| 通信暗号化 | HTTPS通信を推奨 |
| 権限管理 | 管理者専用：管理者権限を持つユーザーのみアクセス可能<br>（ログイン後は管理者メニューにのみアクセス可能） |

### レイアウト
- レスポンシブデザイン対応（Bootstrap 5.2.3使用）
- 画面中央にログインフォームを配置
- 最大幅：400px程度
- カスタムCSSクラス：`admin-login`, `login-container`

### 使用技術
- Thymeleaf（テンプレートエンジン）
- Bootstrap 5.2.3（CSSフレームワーク）
- Spring Security（認証・認可）

---

## 3. 画面比較表

| 項目 | 一般ユーザーログイン | 管理者ログイン |
|------|---------------------|----------------|
| URL | /login | /admin/login |
| 画面タイトル | ログイン | 管理者ログイン |
| ユーザー名ラベル | ユーザー名 | 管理者ユーザー名 |
| ログイン成功時の遷移先 | /products | /admin/menu |
| ボタンラベル | ログイン | 管理者としてログイン |
| 相互遷移リンク | 管理者の方はこちら | 一般ユーザーの方はこちら |
| CSSクラス | user-login | admin-login |

---

## 4. 補足事項

### 共通仕様
- 両画面ともSpring Securityによる認証を使用
- CSRF保護が有効
- セッション管理はSpring Securityのデフォルト設定を使用
- レスポンシブデザイン対応（モバイル、タブレット、デスクトップ）

### 今後の拡張案
- パスワードリセット機能
- 多要素認証（MFA）の導入
- ログイン試行回数制限
- キャプチャ認証
- パスワード強度チェック
