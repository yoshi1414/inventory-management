# 商品管理画面設計書

## 目次
- [1. 基本情報](#1-基本情報)
- [2. 画面概要](#2-画面概要)
- [3. UI要素一覧](#3-ui要素一覧)
- [4. 機能仕様](#4-機能仕様)
- [5. バリデーション](#5-バリデーション)
- [6. セキュリティ](#6-セキュリティ)
- [7. レイアウト](#7-レイアウト)
- [8. 使用技術](#8-使用技術)
- [9. データ仕様](#9-データ仕様)

---

## 1. 基本情報

| 項目 | 内容 |
|------|------|
| 画面ID | PROD-001 |
| 画面名 | 商品管理画面 |
| URL | /admin/products |
| アクセス権限 | 管理者のみ |
| 作成日 | 2026年2月4日 |
| 更新日 | 2026年2月4日 |

---

## 2. 画面概要

管理者が商品マスタ情報を管理するための画面です。商品の新規登録、編集、削除（論理削除）を1件ずつ行うことができます。また、登録済み商品の一覧表示、検索・フィルタリング機能、CSVインポート・エクスポート機能を提供し、効率的な商品管理を実現します。

### 主な機能
- 商品の新規登録（1件ずつ）
- 商品情報の編集（フォームに読み込んで更新）
- 商品の論理削除（削除確認モーダル表示）
- 登録済み商品の一覧表示（ページネーション対応）
- 商品名・商品IDによる検索
- カテゴリ・ステータスによるフィルタリング
- CSV一括登録（インポート）
- CSVエクスポート
- 在庫管理画面への遷移

### 画面の特徴
- **1件ずつの入力・編集**：この画面では商品情報を1件ずつ入力・編集します
- **在庫数の確認は在庫管理画面で**：在庫数の一覧表示や在庫操作は在庫管理画面で行います
- **一括登録はCSVインポート**：複数商品の一括登録はCSVインポート機能を使用します

---

## 3. UI要素一覧

### 3.1 ナビゲーションバー（管理者用）

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 1 | ロゴ/リンク | システム名 | link | - | 「商品在庫管理システム」<br>/admin/menuへ遷移<br>管理者バッジ表示 |
| 2 | ナビゲーションリンク | 在庫管理 | link | - | /admin/inventoryへ遷移<br>アイコン：bi-clipboard-data |
| 3 | ナビゲーションリンク | 商品管理 | link | - | /admin/productsへ遷移<br>アイコン：bi-box-seam<br>現在地：active状態 |
| 4 | ナビゲーションリンク | ユーザー管理 | link | - | /admin/usersへ遷移<br>アイコン：bi-people |
| 5 | ナビゲーションリンク | メニュー | link | - | /admin/menuへ遷移<br>アイコン：bi-house |
| 6 | ボタン | ログアウト | submit | - | /logoutへPOST送信<br>アイコン：bi-box-arrow-right |

### 3.2 ページヘッダー

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 7 | 見出し | ページタイトル | - | - | 「商品管理」<br>アイコン：bi-box-seam |
| 8 | ボタングループ | アクション | - | - | 右上に配置 |
| 9 | ボタン | 新規商品登録 | button | - | /admin/products/createへ遷移<br>アイコン：bi-plus-circle<br>スタイル：btn-success btn-lg |
| 10 | ボタン | 在庫一覧へ | button | - | /admin/inventoryへ遷移<br>アイコン：bi-clipboard-data<br>スタイル：btn-outline-primary btn-lg |

### 3.3 説明パネル

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 11 | アラート | 画面説明 | alert-info | - | 商品管理画面の使い方を説明<br>在庫管理画面へのリンク付き<br>CSVインポートへのリンク付き |

### 3.4 検索・フィルタリングパネル

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 12 | 見出し | パネルタイトル | - | - | 「登録済み商品を検索」<br>アイコン：bi-search |
| 13 | 入力欄 | 商品名・ID検索 | text | 任意 | プレースホルダー：「商品名または商品IDを入力」<br>部分一致検索 |
| 14 | セレクトボックス | カテゴリフィルタ | select | 任意 | オプション：全て、Electronics、Clothing、Home Appliances |
| 15 | セレクトボックス | ステータスフィルタ | select | 任意 | オプション：全て、販売中(active)、販売停止(inactive) |
| 16 | ボタン | 検索ボタン | submit | - | 検索実行<br>アイコン：bi-search<br>スタイル：btn-primary w-100 |
| 17 | ボタン | クリアボタン | reset | - | フォームリセット<br>アイコン：bi-x-circle<br>スタイル：btn-secondary btn-sm |
| 18 | ボタン | CSV一括登録 | button | - | /admin/products/importへ遷移<br>アイコン：bi-upload<br>スタイル：btn-outline-success btn-sm |
| 19 | ボタン | CSVエクスポート | button | - | /admin/products/exportへ遷移<br>アイコン：bi-download<br>スタイル：btn-outline-primary btn-sm |

### 3.5 登録済み商品一覧テーブル

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 20 | テーブルヘッダー | 商品ID | - | - | 幅：10% |
| 21 | テーブルヘッダー | 商品名 | - | - | 幅：20% |
| 22 | テーブルヘッダー | カテゴリ | - | - | 幅：12% |
| 23 | テーブルヘッダー | 価格 | - | - | 幅：10% |
| 24 | テーブルヘッダー | 在庫数 | - | - | 幅：8% |
| 25 | テーブルヘッダー | ステータス | - | - | 幅：10% |
| 26 | テーブルヘッダー | 更新日 | - | - | 幅：15% |
| 27 | テーブルヘッダー | 操作 | - | - | 幅：15% |
| 28 | テーブルセル | 商品ID表示 | code | - | `<code>`タグで表示 |
| 29 | テーブルセル | 商品名表示 | text | - | 通常テキスト |
| 30 | テーブルセル | カテゴリ表示 | badge | - | Badgeで表示<br>Electronics：bg-primary<br>Clothing：bg-info<br>Home Appliances：bg-secondary |
| 31 | テーブルセル | 価格表示 | text | - | ¥表記<br>カンマ区切り表示 |
| 32 | テーブルセル | 在庫数表示 | text | - | 数値表示<br>0個：stock-danger（赤）<br>1-20個：stock-warning（黄）<br>21個以上：stock-ok（緑） |
| 33 | テーブルセル | ステータス表示 | badge | - | 販売中：badge-status-active<br>販売停止：badge-status-inactive |
| 34 | テーブルセル | 更新日表示 | text | - | YYYY-MM-DD形式 |
| 35 | テーブルセル/ボタングループ | 操作ボタン | button | - | 編集・削除ボタン |
| 36 | ボタン | 編集ボタン | button | - | onclick：editProduct(商品ID)<br>商品情報をフォームに読み込む<br>アイコン：bi-pencil<br>スタイル：btn-sm btn-primary |
| 37 | ボタン | 削除ボタン | button | - | onclick：handleDelete(商品ID)<br>削除確認モーダルを表示<br>アイコン：bi-trash<br>スタイル：btn-sm btn-outline-danger |

### 3.6 ページネーション

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 38 | リンク | 最初のページ | link | - | 最初のページへ遷移<br>アイコン：bi-chevron-double-left<br>ラベル：「最初」 |
| 39 | リンク | 前のページ | link | - | 前のページへ遷移<br>アイコン：bi-chevron-left<br>ラベル：「前へ」 |
| 40 | リンク | ページ番号 | link | - | 各ページへ遷移<br>現在ページは「active」クラス |
| 41 | リンク | 次のページ | link | - | 次のページへ遷移<br>アイコン：bi-chevron-right<br>ラベル：「次へ」 |
| 42 | リンク | 最後のページ | link | - | 最後のページへ遷移<br>アイコン：bi-chevron-double-right<br>ラベル：「最後」 |
| 43 | テキスト | ページ情報 | text | - | 「全X件中 Y-Z件を表示 (ページ N/M) ※1ページあたりZ件表示」 |

### 3.7 商品情報入力フォーム

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 44 | カードヘッダー | フォームタイトル | - | - | 「商品情報入力」<br>アイコン：bi-pencil-square<br>スタイル：bg-primary text-white |
| 45 | 入力欄 | 商品ID | text | 任意 | プレースホルダー：「自動生成または手動入力」<br>空欄の場合は自動生成<br>編集時は表示のみ |
| 46 | 入力欄 | 商品名 | text | 必須 | プレースホルダー：「商品名を入力」<br>最大255文字<br>required属性 |
| 47 | セレクトボックス | カテゴリ | select | 必須 | オプション：<br>- 選択してください<br>- Electronics<br>- Clothing<br>- Home Appliances<br>required属性 |
| 48 | 入力欄 | 価格 | number | 必須 | プレースホルダー：「0」<br>数値のみ入力可能<br>0以上<br>required属性 |
| 49 | 入力欄 | 在庫数 | number | 必須 | プレースホルダー：「0」<br>数値のみ入力可能<br>0以上<br>required属性 |
| 50 | セレクトボックス | ステータス | select | 必須 | オプション：<br>- 販売中(active)<br>- 販売停止(inactive)<br>デフォルト：販売中<br>required属性 |
| 51 | 入力欄 | 説明 | textarea | 任意 | プレースホルダー：「商品の説明を入力（任意）」<br>最大500文字<br>行数：3行 |
| 52 | ボタングループ | フォーム操作 | - | - | 下部に配置 |
| 53 | ボタン | 登録ボタン | submit | - | 商品を登録/更新<br>アイコン：bi-check-circle<br>スタイル：btn-primary btn-lg<br>ラベル：「登録する」 |
| 54 | ボタン | クリアボタン | reset | - | フォームをリセット<br>アイコン：bi-x-circle<br>スタイル：btn-secondary btn-lg<br>ラベル：「クリア」 |

### 3.8 削除確認モーダル

| No | 要素種別 | 項目名 | 入力形式 | 必須/任意 | 備考 |
|----|----------|--------|----------|-----------|------|
| 55 | モーダルヘッダー | タイトル | - | - | 「削除確認」<br>アイコン：bi-exclamation-triangle<br>スタイル：bg-danger text-white |
| 56 | テキスト | 確認メッセージ | text | - | 「この商品を削除してもよろしいですか？」 |
| 57 | テキスト | 注意事項 | text | - | 「※論理削除されるため、データは保持されます。」<br>スタイル：text-muted |
| 58 | テキスト | 商品ID表示 | text | - | 「商品ID: {商品ID}」<br>削除対象の商品IDを表示 |
| 59 | ボタングループ | モーダル操作 | - | - | フッター部分 |
| 60 | ボタン | キャンセルボタン | button | - | モーダルを閉じる<br>スタイル：btn-secondary<br>data-bs-dismiss="modal" |
| 61 | ボタン | 削除実行ボタン | button | - | onclick：confirmDelete()<br>削除処理を実行<br>スタイル：btn-danger<br>ラベル：「削除する」 |

---

## 4. 機能仕様

### 4.1 画面表示機能

#### 4.1.1 商品一覧表示
- **処理概要**：登録されている商品の情報を一覧表示
- **表示項目**：商品ID、商品名、カテゴリ、価格、在庫数、ステータス、更新日、操作ボタン
- **表示順**：デフォルトは商品名昇順
- **ページング**：1ページあたり4件表示（サンプル）、実際は20件表示を想定
- **在庫数表示ルール**：
  - 0個：在庫切れ（赤色、アイコン付き）
  - 1-20個：在庫不足（黄色、アイコン付き）
  - 21個以上：在庫十分（緑色）

#### 4.1.2 説明パネル表示
- **表示条件**：常時表示
- **表示内容**：
  - この画面では商品情報を1件ずつ入力・編集できること
  - 在庫数の確認や一括表示は在庫管理画面で行うこと
  - 複数商品の一括登録はCSVインポートを利用すること
- **スタイル**：alert-info（青色背景）
- **アイコン**：bi-info-circle

### 4.2 検索・フィルタリング機能

#### 4.2.1 商品名・ID検索
- **検索方式**：部分一致検索
- **対象項目**：商品名、商品ID
- **大文字小文字**：区別しない
- **動作**：検索ボタン押下時に実行

#### 4.2.2 カテゴリフィルタ
- **選択肢**：全て、Electronics、Clothing、Home Appliances
- **動作**：選択したカテゴリの商品のみ表示
- **デフォルト**：全て

#### 4.2.3 ステータスフィルタ
- **選択肢**：全て、販売中(active)、販売停止(inactive)
- **動作**：選択したステータスの商品のみ表示
- **デフォルト**：全て

#### 4.2.4 クリア機能
- **動作**：全ての検索・フィルタ条件をリセット
- **実行方法**：クリアボタン押下

### 4.3 商品登録機能

#### 4.3.1 新規登録
- **処理概要**：新しい商品をデータベースに登録
- **入力項目**：
  - 商品ID（任意、空欄の場合は自動生成）
  - 商品名（必須）
  - カテゴリ（必須）
  - 価格（必須、0以上）
  - 在庫数（必須、0以上）
  - ステータス（必須、デフォルト：販売中）
  - 説明（任意）
- **処理フロー**：
  1. フォームに商品情報を入力
  2. バリデーションチェック
  3. 登録ボタン押下
  4. サーバー側でデータ検証
  5. データベースに保存
  6. 成功メッセージ表示
  7. フォームをクリア
  8. 一覧をリフレッシュ

#### 4.3.2 登録処理
- **商品ID生成**：8文字のランダム英数字を自動生成
- **登録日時**：サーバー側で自動設定
- **更新日時**：サーバー側で自動設定
- **削除フラグ**：初期値はfalse（削除されていない）

### 4.4 商品編集機能

#### 4.4.1 編集フォームへの読み込み
- **起動方法**：一覧テーブルの「編集」ボタンをクリック
- **処理フロー**：
  1. 編集ボタンクリック（editProduct関数実行）
  2. 商品IDを取得
  3. サーバーから商品データを取得（または画面内データを使用）
  4. 各フォームフィールドに値をセット
  5. フォームまでスムーズスクロール
- **フォーム表示**：
  - 商品ID：表示のみ（編集不可）
  - 商品名：現在の値を表示
  - カテゴリ：現在の値を選択
  - 価格：現在の値を表示
  - 在庫数：現在の値を表示
  - ステータス：現在の値を選択
  - 説明：現在の値を表示

#### 4.4.2 更新処理
- **処理概要**：既存の商品情報を更新
- **処理フロー**：
  1. フォームで商品情報を編集
  2. バリデーションチェック
  3. 登録ボタン押下
  4. サーバー側でデータ検証
  5. 商品IDが存在する場合は更新処理
  6. 更新日時を自動更新
  7. データベースを更新
  8. 成功メッセージ表示
  9. 一覧をリフレッシュ

### 4.5 商品削除機能

#### 4.5.1 削除確認モーダル表示
- **起動方法**：一覧テーブルの「削除」ボタンをクリック
- **処理フロー**：
  1. 削除ボタンクリック（handleDelete関数実行）
  2. 商品IDを取得
  3. モーダルに商品IDを表示
  4. 削除確認モーダルを表示

#### 4.5.2 論理削除処理
- **処理概要**：商品を論理削除（deleted_atに日時を設定）
- **処理フロー**：
  1. モーダルの「削除する」ボタンをクリック（confirmDelete関数実行）
  2. 商品IDを取得
  3. サーバーに削除リクエスト送信
  4. deleted_atカラムに現在日時を設定
  5. 削除済みステータスに変更
  6. 成功メッセージ表示
  7. モーダルを閉じる
  8. 一覧をリフレッシュ（削除された商品は非表示）
- **注意事項**：
  - データは物理削除されず、deleted_atフラグで管理
  - 削除済み商品は通常の一覧には表示されない
  - 管理者は削除済み商品を復元可能（別機能）

### 4.6 CSV機能

#### 4.6.1 CSV一括登録（インポート）
- **遷移先**：/admin/products/import
- **処理概要**：CSVファイルから商品データを一括登録
- **ファイル形式**：
  - 文字コード：UTF-8
  - 列：商品ID、商品名、カテゴリ、価格、在庫数、ステータス、説明
- **バリデーション**：
  - 商品IDの重複チェック
  - 必須項目のチェック
  - データ型のチェック
  - 最大1000件まで
- **処理後**：
  - 各商品を登録
  - 処理結果サマリーを表示（成功件数、失敗件数、エラー詳細）

#### 4.6.2 CSVエクスポート
- **遷移先**：/admin/products/export
- **処理概要**：現在の表示条件に基づいて商品データをCSV出力
- **ファイル名**：products_YYYYMMDD_HHmmss.csv
- **出力項目**：商品ID、商品名、カテゴリ、価格、在庫数、ステータス、説明、登録日、更新日
- **文字コード**：UTF-8（BOM付き）
- **Excel対応**：カンマ区切り、ダブルクォートで囲む

### 4.7 ページネーション機能

#### 4.7.1 ページ遷移
- **処理概要**：商品一覧を複数ページに分割して表示
- **1ページあたりの表示件数**：20件（変更可能）
- **ナビゲーション**：
  - 最初のページ：1ページ目へ遷移
  - 前のページ：現在のページ-1へ遷移
  - ページ番号：指定ページへ遷移
  - 次のページ：現在のページ+1へ遷移
  - 最後のページ：最終ページへ遷移
- **状態管理**：
  - 1ページ目の場合：「最初」「前へ」ボタンは無効
  - 最終ページの場合：「次へ」「最後」ボタンは無効
  - 現在のページ番号はactiveクラスでハイライト

#### 4.7.2 ページ情報表示
- **表示内容**：全X件中 Y-Z件を表示 (ページ N/M)
- **計算方法**：
  - 全件数：総商品数
  - 表示開始位置：(現在のページ - 1) × 表示件数 + 1
  - 表示終了位置：min(現在のページ × 表示件数, 総商品数)
  - 総ページ数：ceil(総商品数 / 表示件数)

### 4.8 画面遷移機能

#### 4.8.1 在庫管理画面への遷移
- **遷移方法**：
  - ページヘッダーの「在庫一覧へ」ボタンをクリック
  - 説明パネル内の「在庫管理画面」リンクをクリック
- **遷移先**：/admin/inventory

#### 4.8.2 CSVインポート画面への遷移
- **遷移方法**：
  - 検索パネル内の「CSV一括登録」ボタンをクリック
  - 説明パネル内の「CSVインポート」リンクをクリック
- **遷移先**：/admin/products/import

#### 4.8.3 新規商品登録画面への遷移
- **遷移方法**：ページヘッダーの「新規商品登録」ボタンをクリック
- **遷移先**：/admin/products/create
- **注意**：現在の画面内フォームでも登録可能

#### 4.8.4 管理者メニューへの遷移
- **遷移方法**：
  - ナビゲーションバーのシステム名をクリック
  - ナビゲーションバーの「メニュー」をクリック
- **遷移先**：/admin/menu

#### 4.8.5 他の管理画面への遷移
- **在庫管理**：/admin/inventory
- **ユーザー管理**：/admin/users

#### 4.8.6 ログアウト
- **実行方法**：ナビゲーションバーの「ログアウト」ボタンをクリック
- **処理**：/logoutへPOST送信
- **遷移先**：ログイン画面（/admin/login）

---

## 5. バリデーション

### 5.1 入力バリデーション

| 項目 | バリデーション内容 |
|------|-------------------|
| 商品ID | ・任意入力<br>・英数字のみ（8文字推奨）<br>・既存の商品IDと重複不可<br>・空欄の場合は自動生成 |
| 商品名 | ・必須入力<br>・最大文字数：255文字<br>・空白のみの入力不可 |
| カテゴリ | ・必須選択<br>・選択肢：Electronics、Clothing、Home Appliances<br>・「選択してください」のままでは登録不可 |
| 価格 | ・必須入力<br>・数値のみ入力可能<br>・0以上の整数<br>・最大値：999,999,999円 |
| 在庫数 | ・必須入力<br>・数値のみ入力可能<br>・0以上の整数<br>・最大値：999,999個 |
| ステータス | ・必須選択<br>・選択肢：販売中(active)、販売停止(inactive)<br>・デフォルト：販売中 |
| 説明 | ・任意入力<br>・最大文字数：500文字 |

### 5.2 検索フィルタバリデーション

| 項目 | バリデーション内容 |
|------|-------------------|
| 商品名・ID検索 | ・任意入力<br>・最大文字数：100文字 |
| カテゴリフィルタ | ・選択式<br>・無効な値は受け付けない |
| ステータスフィルタ | ・選択式<br>・無効な値は受け付けない |

### 5.3 CSVインポートバリデーション

| 項目 | バリデーション内容 |
|------|-------------------|
| ファイル形式 | ・CSV形式のみ<br>・最大ファイルサイズ：5MB |
| 文字コード | ・UTF-8のみ |
| データ件数 | ・1件以上1000件以下 |
| 商品ID | ・任意（空欄の場合は自動生成）<br>・既存の商品IDと重複不可 |
| 商品名 | ・必須<br>・最大255文字 |
| カテゴリ | ・必須<br>・有効な値：Electronics、Clothing、Home Appliances |
| 価格 | ・必須<br>・0以上の整数 |
| 在庫数 | ・必須<br>・0以上の整数 |
| ステータス | ・必須<br>・有効な値：active、inactive |

### 5.4 エラーメッセージ

| エラー種別 | メッセージ内容 |
|-----------|---------------|
| 商品名未入力 | 「商品名を入力してください。」 |
| 商品名文字数超過 | 「商品名は255文字以内で入力してください。」 |
| カテゴリ未選択 | 「カテゴリを選択してください。」 |
| 価格未入力 | 「価格を入力してください。」 |
| 価格が数値でない | 「価格は数値で入力してください。」 |
| 価格が負の値 | 「価格は0以上で入力してください。」 |
| 価格が最大値超過 | 「価格は999,999,999円以下で入力してください。」 |
| 在庫数未入力 | 「在庫数を入力してください。」 |
| 在庫数が数値でない | 「在庫数は数値で入力してください。」 |
| 在庫数が負の値 | 「在庫数は0以上で入力してください。」 |
| 在庫数が最大値超過 | 「在庫数は999,999個以下で入力してください。」 |
| 商品ID重複 | 「商品ID「{ID}」は既に使用されています。」 |
| CSV形式エラー | 「CSVファイルの形式が正しくありません。」 |
| CSV件数超過 | 「CSVファイルの件数は1000件以下にしてください。」 |
| CSVデータエラー | 「行{N}：{項目名}が不正です。{詳細}」 |
| 権限エラー | 「この操作を実行する権限がありません。」 |
| システムエラー | 「システムエラーが発生しました。管理者に連絡してください。」 |

---

## 6. セキュリティ

### 6.1 認証・認可

| 項目 | 対策内容 |
|------|---------|
| 認証 | ・管理者ログイン認証必須<br>・未認証ユーザーは管理者ログイン画面へリダイレクト |
| 認可 | ・管理者権限チェック<br>・一般ユーザーがアクセスした場合は403エラー |
| セッション管理 | ・Spring Securityによるセッション管理<br>・セッションタイムアウト：30分<br>・管理者専用セッション |
| CSRF対策 | ・全てのPOSTリクエストでCSRFトークン検証を実施<br>・フォーム送信、削除処理で必須 |

### 6.2 入力値検証

| 項目 | 対策内容 |
|------|---------|
| XSS対策 | ・Thymeleafのエスケープ機能を使用<br>・ユーザー入力値（商品名、説明など）を全てエスケープ処理<br>・CSVインポート時の入力値もエスケープ |
| SQLインジェクション対策 | ・PreparedStatementを使用<br>・JPAのパラメータバインディングを使用<br>・動的SQLは使用しない |
| パラメータ改ざん対策 | ・サーバーサイドでの入力値検証を実施<br>・商品ID、価格、在庫数などの改ざんチェック<br>・権限チェック（管理者のみ実行可能） |
| ファイルアップロード対策 | ・許可する拡張子：.csvのみ<br>・最大ファイルサイズ制限：5MB<br>・ウイルススキャン（本番環境推奨） |

### 6.3 データ保護

| 項目 | 対策内容 |
|------|---------|
| 通信暗号化 | ・HTTPS通信を推奨<br>・本番環境ではHTTPSを必須とする |
| ログ記録 | ・商品の登録・更新・削除操作をログに記録<br>・誰が（user_id）いつ（timestamp）何を（商品ID、操作内容）したかを記録<br>・管理者操作ログを別途記録 |
| 監査証跡 | ・商品マスタの変更履歴を記録<br>・削除操作は論理削除で記録を保持<br>・CSV一括登録の場合もバッチIDで紐付け |

### 6.4 アクセス制御

| 項目 | 対策内容 |
|------|---------|
| URL直接アクセス防止 | ・管理者権限チェックをフィルタで実施<br>・権限がない場合は403エラー |
| 画面表示制御 | ・管理者専用機能は権限チェック後に表示<br>・一般ユーザーには表示しない |
| API制限 | ・管理者APIは権限チェック必須<br>・レート制限の実装（DDoS対策） |

---

## 7. レイアウト

### 7.1 画面構成

```
+--------------------------------------------------+
| ナビゲーションバー (管理者用・固定)                  |
| [🛡️ 商品在庫管理システム 管理者]                  |
| [在庫管理] [商品管理*] [ユーザー管理] [メニュー] [ログアウト] |
+--------------------------------------------------+
| メインコンテンツエリア                              |
| +----------------------------------------------+ |
| | ヘッダー部分                                   | |
| | [商品管理] [新規商品登録] [在庫一覧へ]           | |
| +----------------------------------------------+ |
| | 説明パネル                                     | |
| | この画面では商品情報を1件ずつ入力・編集できます     | |
| +----------------------------------------------+ |
| | 検索・フィルタリングパネル                       | |
| | [商品名検索] [カテゴリ] [ステータス] [検索]      | |
| | [クリア] [CSV一括登録] [CSVエクスポート]         | |
| +----------------------------------------------+ |
| | 登録済み商品一覧テーブル                         | |
| | +------------------------------------------+ | |
| | | ID | 商品名 | カテゴリ | 価格 | 在庫 | ... | | |
| | +------------------------------------------+ | |
| | | サンプルデータ行                            | | |
| | +------------------------------------------+ | |
| | ページネーション                               | |
| +----------------------------------------------+ |
| | 商品情報入力フォーム                            | |
| | [商品ID] [商品名] [カテゴリ]                   | |
| | [価格] [在庫数] [ステータス] [説明]             | |
| | [登録する] [クリア]                            | |
| +----------------------------------------------+ |
+--------------------------------------------------+
```

### 7.2 レスポンシブデザイン

| デバイス | レイアウト |
|---------|----------|
| デスクトップ（1200px以上） | ・フル幅表示<br>・テーブルは横スクロール対応<br>・フォームは2列レイアウト |
| タブレット（768px-1199px） | ・幅調整<br>・テーブルは横スクロール必須<br>・フォームは2列維持 |
| モバイル（767px以下） | ・単列表示<br>・テーブルはカード表示に変更推奨<br>・フォームは1列レイアウト |

### 7.3 カラーテーマ

| 要素 | カラー | 備考 |
|-----|--------|------|
| ナビゲーションバー | 青系（管理者用） | navbar-custom-admin |
| 管理者バッジ | 赤 | badge admin-badge |
| プライマリボタン | 青 | btn-primary |
| 成功ボタン | 緑 | btn-success |
| 警告ボタン | 黄 | btn-warning |
| 危険ボタン | 赤 | btn-danger |
| 在庫切れ表示 | 赤 | stock-danger |
| 在庫不足表示 | 黄 | stock-warning |
| 在庫十分表示 | 緑 | stock-ok |
| 販売中バッジ | 緑 | badge-status-active |
| 販売停止バッジ | グレー | badge-status-inactive |

### 7.4 アイコン使用

| 機能 | アイコン | Bootstrap Icon |
|-----|---------|----------------|
| 商品管理 | 📦 | bi-box-seam |
| 検索 | 🔍 | bi-search |
| 編集 | ✏️ | bi-pencil |
| 削除 | 🗑️ | bi-trash |
| 追加 | ➕ | bi-plus-circle |
| チェック | ✅ | bi-check-circle |
| キャンセル | ❌ | bi-x-circle |
| アップロード | ⬆️ | bi-upload |
| ダウンロード | ⬇️ | bi-download |
| 警告 | ⚠️ | bi-exclamation-triangle |
| 情報 | ℹ️ | bi-info-circle |
| リスト | 📋 | bi-list-ul |

---

## 8. 使用技術

### 8.1 フロントエンド

| 技術 | バージョン | 用途 |
|-----|-----------|------|
| HTML5 | - | マークアップ |
| CSS3 | - | スタイリング |
| JavaScript | ES6+ | クライアントサイド処理 |
| Bootstrap | 5.2.3 | UIフレームワーク |
| Bootstrap Icons | 1.10.0 | アイコン表示 |

### 8.2 バックエンド

| 技術 | バージョン | 用途 |
|-----|-----------|------|
| Java | 17 | プログラミング言語 |
| Spring Boot | 3.x | フレームワーク |
| Spring Security | 6.x | 認証・認可 |
| Spring Data JPA | 3.x | データアクセス |
| Thymeleaf | 3.x | テンプレートエンジン |

### 8.3 データベース

| 技術 | バージョン | 用途 |
|-----|-----------|------|
| PostgreSQL / MySQL | 14+ / 8+ | リレーショナルデータベース |

### 8.4 ライブラリ

| ライブラリ | 用途 |
|-----------|------|
| Lombok | ボイラープレートコード削減 |
| Validation API | バリデーション |
| OpenCSV | CSV処理 |

---

## 9. データ仕様

### 9.1 商品マスタテーブル（products）

| カラム名 | データ型 | NULL | デフォルト値 | 備考 |
|---------|---------|------|------------|------|
| product_id | VARCHAR(8) | NOT NULL | - | 主キー、8文字の英数字 |
| product_name | VARCHAR(255) | NOT NULL | - | 商品名 |
| category | VARCHAR(50) | NOT NULL | - | カテゴリ（Electronics/Clothing/Home Appliances） |
| price | INTEGER | NOT NULL | 0 | 価格（円） |
| stock | INTEGER | NOT NULL | 0 | 在庫数 |
| status | VARCHAR(20) | NOT NULL | 'active' | ステータス（active/inactive） |
| description | TEXT | NULL | NULL | 商品説明 |
| created_at | TIMESTAMP | NOT NULL | CURRENT_TIMESTAMP | 登録日時 |
| updated_at | TIMESTAMP | NOT NULL | CURRENT_TIMESTAMP | 更新日時 |
| deleted_at | TIMESTAMP | NULL | NULL | 削除日時（論理削除） |

### 9.2 カテゴリマスタ

| カテゴリ値 | 表示名 | 表示色 |
|-----------|--------|--------|
| Electronics | Electronics | bg-primary（青） |
| Clothing | Clothing | bg-info（水色） |
| Home Appliances | Home Appliances | bg-secondary（グレー） |

### 9.3 ステータスマスタ

| ステータス値 | 表示名 | 表示色 |
|-----------|--------|--------|
| active | 販売中 | badge-status-active（緑） |
| inactive | 販売停止 | badge-status-inactive（グレー） |

### 9.4 CSVフォーマット

#### インポート用CSVフォーマット
```csv
商品ID,商品名,カテゴリ,価格,在庫数,ステータス,説明
ABC12345,サンプル商品,Electronics,10000,50,active,これはサンプルです
```

#### エクスポート用CSVフォーマット
```csv
商品ID,商品名,カテゴリ,価格,在庫数,ステータス,説明,登録日,更新日
ABC12345,サンプル商品,Electronics,10000,50,active,これはサンプルです,2026-02-04,2026-02-04
```

### 9.5 データ制約

| 項目 | 制約 |
|-----|------|
| 商品ID | ・一意制約<br>・8文字の英数字<br>・大文字推奨 |
| 商品名 | ・NOT NULL<br>・最大255文字<br>・空白のみ不可 |
| カテゴリ | ・NOT NULL<br>・有効な値：Electronics, Clothing, Home Appliances |
| 価格 | ・NOT NULL<br>・0以上<br>・最大999,999,999円 |
| 在庫数 | ・NOT NULL<br>・0以上<br>・最大999,999個 |
| ステータス | ・NOT NULL<br>・有効な値：active, inactive |
| 説明 | ・NULL許可<br>・最大500文字 |

---

## 10. 補足事項

### 10.1 在庫管理との連携
- 商品管理画面では商品マスタ情報を管理
- 在庫数の詳細な管理や入出庫操作は在庫管理画面で実施
- 両画面間のスムーズな遷移を提供

### 10.2 今後の拡張予定
- 商品画像のアップロード機能
- 商品カテゴリの階層構造対応
- 商品のバーコード管理機能
- 在庫履歴の表示機能
- 商品の複製機能
- 商品の一括編集機能

### 10.3 パフォーマンス考慮
- ページネーションによる表示件数制限
- インデックスの適切な設定
- キャッシュの活用
- 画像の遅延読み込み（将来実装時）

---

**文書管理情報**
- **作成者**：システム管理者
- **承認者**：プロジェクトマネージャー
- **配布先**：開発チーム全員
- **更新履歴**：
  - 2026年2月4日：初版作成
